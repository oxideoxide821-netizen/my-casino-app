<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEURO-SIGIL SUPREME</title>
    <script src="https://cdnjs.cloudflare.com"></script>
    <script src="https://telegram.org"></script>
    <style>
        :root { --neon: #00f2ff; --gold: #ffcc00; --bg: #050505; }
        body { margin: 0; padding: 0; background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        #ui {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 88%; padding: 20px; border-radius: 28px;
            background: rgba(15, 15, 15, 0.7); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); z-index: 100; text-align: center;
        }

        input {
            width: 90%; background: rgba(0,0,0,0.5); border: 1px solid rgba(0,242,255,0.2);
            border-radius: 15px; padding: 15px; color: var(--neon); font-size: 16px; 
            outline: none; margin-bottom: 15px; transition: 0.4s; text-align: center;
        }

        .btn-group { display: flex; gap: 10px; }
        button {
            flex: 2; background: linear-gradient(135deg, #00f2ff, #0066ff);
            border: none; color: white; padding: 16px; border-radius: 15px;
            font-weight: 800; text-transform: uppercase; cursor: pointer; font-size: 12px;
        }

        #gold-btn {
            flex: 1; background: linear-gradient(135deg, #ff9900, #ffcc00);
            color: #000; box-shadow: 0 0 20px rgba(255,204,0,0.3);
        }

        #status { margin-top: 12px; font-size: 9px; color: var(--neon); letter-spacing: 2px; opacity: 0.6; }
        .creator-tag { color: var(--gold); font-weight: bold; margin-bottom: 5px; display: block; font-size: 10px; }
    </style>
</head>
<body>
    <div id="ui">
        <span id="admin-badge" class="creator-tag" style="display:none">CREATOR ACCESS GRANTED</span>
        <input type="text" id="goal" placeholder="ВВЕДИ СВОЙ ЗАПРОС...">
        <div class="btn-group">
            <button onclick="activate(false)">ГЕНЕРАЦИЯ</button>
            <button id="gold-btn" onclick="checkGold()">GOLD UPGRADE</button>
        </div>
        <div id="status">NEURAL LINK IDLE</div>
    </div>

<script>
let tg = window.Telegram.WebApp;
tg.expand();
tg.enableClosingConfirmation();

const CREATOR_ID = "Random"; // Твой username без @ для проверки в SDK
let isGold = false;
let particles = [];
let sigilPoints = [];
let active = false;
let colorTheme = [0, 242, 255];

// Проверка на Создателя
if (tg.initDataUnsafe?.user?.username === "Random") {
    document.getElementById('admin-badge').style.display = 'block';
    document.getElementById('gold-btn').innerText = "CREATOR GOLD";
}

function setup() {
    createCanvas(windowWidth, windowHeight);
    for(let i=0; i<80; i++) particles.push(new Particle());
}

function draw() {
    background(5, 5, 5, 50);
    particles.forEach(p => { p.update(); p.show(); });

    if (active) {
        translate(width/2, height/2 - 60);
        let t = frameCount * 0.02;
        
        noFill();
        strokeWeight(isGold ? 3 : 1.5);
        stroke(colorTheme[0], colorTheme[1], colorTheme[2], 180);

        beginShape();
        sigilPoints.forEach((pt, i) => {
            let n = noise(t + i) * (isGold ? 40 : 10);
            let x = pt.x + cos(t + i) * n;
            let y = pt.y + sin(t + i) * n;
            curveVertex(x, y);
            if(isGold && i % 2 == 0) {
                push(); stroke(255, 200, 0, 100); ellipse(x, y, n/2); pop();
            }
        });
        endShape(CLOSE);
    }
}

function activate(goldMode) {
    let val = document.getElementById('goal').value;
    if(!val) { tg.showAlert("Введите запрос!"); return; }

    isGold = goldMode;
    colorTheme = isGold ? [255, 204, 0] : [0, 242, 255];
    
    let seed = 0;
    for(let i=0; i<val.length; i++) seed += val.charCodeAt(i);
    
    sigilPoints = [];
    let steps = isGold ? 25 : 12;
    for(let i=0; i<steps; i++) {
        let ang = map(i, 0, steps, 0, TWO_PI);
        let rad = (seed * (i+3) % (isGold ? 150 : 100)) + 50;
        sigilPoints.push({ x: cos(ang)*rad, y: sin(ang)*rad });
    }

    active = true;
    document.getElementById('status').innerText = isGold ? "GOLDEN RESONANCE ACTIVE" : "STANDARD SIGIL SYNCED";
    tg.HapticFeedback.notificationOccurred(isGold ? 'success' : 'warning');
}

function checkGold() {
    // Если ты - Создатель, включаем сразу
    if (tg.initDataUnsafe?.user?.username === "Random") {
        activate(true);
    } else {
        // Для остальных - запрос звезд через бота
        tg.showConfirm("Активировать GOLD-режим за 50 Звёзд?", (ok) => {
            if(ok) {
                // Здесь вызывается платеж. В Mini App это делается через bot API
                tg.showAlert("Счет на оплату отправлен в чат с ботом!");
                // Логика: бот должен отправить Invoice пользователю
            }
        });
    }
}

class Particle {
    constructor() { this.pos = createVector(random(width), random(height)); this.vel = createVector(random(-0.7, 0.7), random(-0.7, 0.7)); }
    update() { 
        this.pos.add(this.vel); 
        if(this.pos.x<0 || this.pos.x>width) this.vel.x*=-1; 
        if(this.pos.y<0 || this.pos.y>height) this.vel.y*=-1; 
    }
    show() { 
        stroke(isGold ? 255 : 0, isGold ? 200 : 242, isGold ? 0 : 255, 40); 
        point(this.pos.x, this.pos.y); 
    }
}
</script>
</body>
</html>
