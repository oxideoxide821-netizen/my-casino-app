<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://telegram.org"></script>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #050608; --card: #111418; --accent: #00f2ff; --red: #ff4757; }
        body { background: var(--bg); color: #fff; font-family: 'Unbounded', sans-serif; margin: 0; overflow: hidden; height: 100vh; user-select: none; }
        
        /* HEADER */
        .header { padding: 15px 20px; background: rgba(17,20,24,0.9); backdrop-filter: blur(10px); border-bottom: 1px solid #222; display: flex; justify-content: space-between; position: sticky; top: 0; z-index: 100; }
        .bal { color: var(--gold); font-weight: 900; font-size: 18px; }

        /* PAGES */
        .page { height: 82vh; overflow-y: auto; padding: 15px; display: none; padding-bottom: 120px; }
        .page.active { display: block; animation: fadeIn 0.2s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CASE GRID */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .case { background: var(--card); border-radius: 20px; padding: 15px; text-align: center; border: 1px solid #222; position: relative; }
        .case:active { transform: scale(0.95); border-color: var(--accent); }
        .case-icon { font-size: 45px; display: block; margin-bottom: 10px; filter: drop-shadow(0 0 10px var(--accent)); }

        /* INVENTORY */
        .inv-item { background: #161a1f; border-radius: 15px; padding: 10px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; border: 1px solid #222; }
        .sell-btn { background: var(--red); color: white; border: none; padding: 8px 12px; border-radius: 8px; font-size: 10px; font-weight: bold; }

        /* LEADERS */
        .lead-row { display: flex; justify-content: space-between; padding: 12px; background: #111418; border-radius: 12px; margin-bottom: 6px; border-left: 3px solid var(--accent); }

        /* REAL VIRUS ROULETTE */
        #roulette { position: fixed; inset: 0; background: #000; z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .view-port { width: 100%; height: 140px; position: relative; overflow: hidden; background: #080808; border-top: 2px solid #222; border-bottom: 2px solid #222; }
        .reel { display: flex; position: absolute; left: 50%; align-items: center; height: 100%; will-change: transform; }
        .slot { min-width: 110px; height: 120px; display: flex; align-items: center; justify-content: center; font-size: 50px; opacity: 0.3; transition: 0.5s; }
        .slot.win { opacity: 1; transform: scale(1.3); filter: drop-shadow(0 0 15px var(--gold)); }
        .center-line { position: absolute; left: 50%; width: 3px; height: 100%; background: var(--gold); z-index: 100; transform: translateX(-50%); box-shadow: 0 0 20px var(--gold); }

        /* NAV */
        .nav { position: fixed; bottom: 20px; left: 15px; right: 15px; background: #111418; display: flex; justify-content: space-around; padding: 12px; border-radius: 20px; border: 1px solid #333; box-shadow: 0 0 30px rgba(0,0,0,0.8); }
        .nav-i { font-size: 20px; opacity: 0.3; transition: 0.2s; }
        .nav-i.active { opacity: 1; color: var(--gold); transform: scale(1.2); }

        .btn-action { background: var(--gold); color: #000; border: none; padding: 15px 40px; border-radius: 15px; font-weight: 900; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="bal">ü™ô <span id="balance">15,000</span></div>
        <div style="font-size:10px; color:var(--accent)">ELITE DEB</div>
    </div>

    <!-- –ú–ê–ì–ê–ó–ò–ù (50+ –∫–µ–π—Å–æ–≤) -->
    <div id="p-shop" class="page active"><div class="grid" id="case-container"></div></div>
    
    <!-- –ò–ù–í–ï–ù–¢–ê–†–¨ -->
    <div id="p-inv" class="page"><h3>üéí –ú–û–ô –ò–ù–í–ï–ù–¢–ê–†–¨</h3><div id="inventory-list"></div></div>

    <!-- –õ–ò–î–ï–†–´ -->
    <div id="p-top" class="page"><h3>üèÜ –¢–û–ü –õ–ò–î–ï–†–û–í</h3><div id="leaderboard"></div></div>

    <!-- –ù–ê–°–¢–†–û–ô–ö–ò -->
    <div id="p-set" class="page">
        <h3>‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò</h3>
        <div class="inv-item"><span>–í–∏–±—Ä–∞—Ü–∏—è</span><input type="checkbox" id="set-vibrate" checked></div>
        <button class="btn-action" style="width:100%; background:var(--red); color:white; margin-top:30px;" onclick="tg.close()">–í–´–ô–¢–ò</button>
    </div>

    <!-- –†–£–õ–ï–¢–ö–ê -->
    <div id="roulette">
        <h2 id="r-status" style="letter-spacing:3px;">–í–†–ê–©–ï–ù–ò–ï...</h2>
        <div class="view-port"><div class="center-line"></div><div id="reel" class="reel"></div></div>
        <button id="r-close" class="btn-action" style="display:none;" onclick="closeR()">–ó–ê–ë–†–ê–¢–¨ –î–†–û–ü</button>
    </div>

    <!-- –ú–ï–ù–Æ -->
    <div class="nav">
        <div class="nav-i active" onclick="tab('p-shop', this)">üì¶</div>
        <div class="nav-i" onclick="tab('p-inv', this)">üéí</div>
        <div class="nav-i" onclick="tab('p-top', this)">üèÜ</div>
        <div class="nav-i" onclick="tab('p-set', this)">‚öôÔ∏è</div>
    </div>

    <script>
        let tg = window.Telegram?.WebApp;
        if(tg) tg.expand();

        let state = { bal: 15000, inv: [] };
        const ITEMS = [
            {img:'üçï',n:'–ú—É—Å–æ—Ä',p:100}, {img:'üíä',n:'–í–∏—Ä—É—Å',p:500}, 
            {img:'üß™',n:'–î–ù–ö',p:1500}, {img:'üëæ',n:'–ú—É—Ç–∞–Ω—Ç',p:4500}, 
            {img:'üíé',n:'–ê–ª–º–∞–∑',p:12000}, {img:'üëë',n:'–ö–æ—Ä–æ–Ω–∞',p:60000}
        ];

        // –ê–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è 52 –∫–µ–π—Å–æ–≤
        const container = document.getElementById('case-container');
        for(let i=1; i<=52; i++) {
            let p = i * 1350;
            container.innerHTML += `
                <div class="case" onclick="buyCase(${p})">
                    <span class="case-icon">${ITEMS[i % ITEMS.length].img}</span>
                    <div style="font-size:10px; font-weight:bold;">–ö–ï–ô–° ‚Ññ${i}</div>
                    <div style="color:var(--gold); font-size:12px;">${p.toLocaleString()} ü™ô</div>
                </div>`;
        }

        function buyCase(price) {
            if(state.bal < price) {
                if(tg) tg.showAlert("‚ùå –ù–ï–î–û–°–¢–ê–¢–û–ß–ù–û –°–†–ï–î–°–¢–í!"); 
                else alert("–ù–µ—Ç –¥–µ–Ω–µ–≥!");
                return;
            }
            state.bal -= price; updateUI(); startRoulette(price);
        }

        function startRoulette(price) {
            const r = document.getElementById('roulette'), reel = document.getElementById('reel');
            r.style.display = 'flex'; 
            document.getElementById('r-close').style.display = 'none';
            document.getElementById('r-status').innerText = "–£–î–ê–ß–ê...";
            
            let html = ''; 
            for(let i=0; i<100; i++) html += `<div class="slot">${ITEMS[Math.floor(Math.random() * ITEMS.length)].img}</div>`;
            reel.innerHTML = html;
            
            reel.style.transition = 'none';
            reel.style.transform = 'translateX(-55px)';

            setTimeout(() => {
                const slotW = 110, winIdx = 80;
                const targetShift = (winIdx * slotW) + 55 + (Math.random() * 60 - 30);
                
                reel.style.transition = 'transform 8s cubic-bezier(0.15, 0, 0.05, 1)';
                reel.style.transform = `translateX(-${targetShift}px)`;

                // Haptic Feedback (—Ç–∏–∫–∞–Ω—å–µ)
                let ticks = 0;
                let tInt = setInterval(() => {
                    ticks++;
                    if(document.getElementById('set-vibrate').checked && tg) tg.HapticFeedback.impactOccurred('light');
                    if(ticks > 65) clearInterval(tInt);
                }, 120);
            }, 100);

            setTimeout(() => {
                let prize = ITEMS[Math.floor(Math.random() * ITEMS.length)];
                state.inv.push(prize); updateUI(); renderInv();
                document.getElementById('r-status').innerText = "–í–´–ü–ê–õ–û: " + prize.n;
                document.getElementById('r-close').style.display = 'block';
                const slots = document.querySelectorAll('.slot');
                if(slots[80]) slots[80].classList.add('win');
                if(tg) tg.HapticFeedback.notificationOccurred('success');
            }, 8200);
        }

        function renderInv() {
            document.getElementById('inventory-list').innerHTML = state.inv.map((item, i) => `
                <div class="inv-item">
                    <span>${item.img} ${item.n}</span>
                    <button class="sell-btn" onclick="sell(${i}, ${item.p})">–ü–†–û–î–ê–¢–¨ –ó–ê ${Math.floor(item.p/2)}</button>
                </div>`).join('');
        }

        function sell(i, p) { 
            state.bal += Math.floor(p/2); state.inv.splice(i, 1); 
            updateUI(); renderInv(); 
            if(tg) tg.HapticFeedback.impactOccurred('medium');
        }

        function tab(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-i').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
        }

        function updateUI() { 
            document.getElementById('balance').innerText = state.bal.toLocaleString();
            document.getElementById('leaderboard').innerHTML = `
                <div class="lead-row"><span>1. Boss_Crypto</span><span>2.5M</span></div>
                <div class="lead-row" style="background:rgba(0,242,255,0.1)"><span>3. –¢–´</span><span>${state.bal.toLocaleString()}</span></div>`;
        }

        function closeR() { document.getElementById('roulette').style.display = 'none'; }
        updateUI();
    </script>
</body>
</html>
